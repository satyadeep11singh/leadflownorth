---
import Layout from '../layouts/Layout.astro';

const contactSchema = {
  "@context": "https://schema.org",
  "@type": "ContactPage",
  "name": "Contact Lead Flow North",
  "description": "Get in touch with Lead Flow North for web design and lead generation services.",
  "url": "https://leadflownorth.com/contact"
};
const bookingUrl = import.meta.env.PUBLIC_BOOKING_URL ?? 'https://meetings-na3.hubspot.com/lead-flow';
const meetingEmbedUrl = (() => {
  try {
    const url = new URL(bookingUrl);
    url.searchParams.set('embed', 'true');
    return url.toString();
  } catch {
    return bookingUrl;
  }
})();
const hubspotContactFormEndpoint = import.meta.env.PUBLIC_HUBSPOT_CONTACT_FORM_ENDPOINT ?? 'https://api.hsforms.com/submissions/v3/integration/submit/342962653/d6f4baca-e5a8-433c-9690-a0cc3c302a0a';
---

<Layout
  title="Contact Us"
  description="Get in touch with Lead Flow North. Book a free 15-minute discovery call or send us a message. We typically respond within 24 hours."
  structuredData={contactSchema}
>
  <!-- Hero -->
  <section class="py-16 lg:py-24 bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-800">
    <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
      <!-- Header -->
      <div class="text-center mb-12">
        <h1 class="text-4xl sm:text-5xl font-extrabold text-slate-900 dark:text-white mb-4">
          Let's Talk About Growing Your Business
        </h1>
        <p class="text-lg text-slate-600 dark:text-slate-300 max-w-2xl mx-auto">
          Choose how you'd like to connect with us. No sales pressure, just honest advice about your online presence.
        </p>
      </div>

      <!-- Option Cards -->
      <div class="grid sm:grid-cols-2 gap-4 mb-8">
        <!-- Send Message Option -->
        <button
          id="option-message"
          data-analytics="contact_option_message_click"
          aria-controls="section-message"
          aria-expanded="true"
          class="option-card active group p-6 bg-white dark:bg-slate-800 rounded-2xl border-2 border-primary-500 dark:border-primary-600 shadow-lg hover:shadow-xl transition-all duration-300 text-left"
        >
          <div class="flex items-start gap-4">
            <div class="w-12 h-12 bg-accent-100 dark:bg-accent-900/30 rounded-xl flex items-center justify-center flex-shrink-0 group-hover:scale-110 transition-transform duration-300">
              <svg class="w-6 h-6 text-accent-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
              </svg>
            </div>
            <div class="flex-1">
              <h3 class="text-xl font-bold text-slate-900 dark:text-white mb-1 group-hover:text-accent-600 dark:group-hover:text-accent-400 transition-colors">
                Send Us a Message
              </h3>
              <p class="text-sm text-slate-600 dark:text-slate-400">
                Fill out a form and we'll respond within 24 hours
              </p>
            </div>
          </div>
        </button>

        <!-- Book a Call Option -->
        <button
          id="option-call"
          data-analytics="contact_option_call_click"
          aria-controls="section-call"
          aria-expanded="false"
          class="option-card group p-6 bg-white dark:bg-slate-800 rounded-2xl border-2 border-slate-200 dark:border-slate-700 shadow-md hover:shadow-lg transition-all duration-300 text-left"
        >
          <div class="flex items-start gap-4">
            <div class="w-12 h-12 bg-primary-100 dark:bg-primary-900/30 rounded-xl flex items-center justify-center flex-shrink-0 group-hover:scale-110 transition-transform duration-300">
              <svg class="w-6 h-6 text-primary-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
              </svg>
            </div>
            <div class="flex-1">
              <h3 class="text-xl font-bold text-slate-900 dark:text-white mb-1 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors">
                Book a Free Call
              </h3>
              <p class="text-sm text-slate-600 dark:text-slate-400">
                15-minute video call to discuss your goals
              </p>
            </div>
          </div>
        </button>
      </div>

      <!-- Expandable Sections -->
      <!-- Send Message Section -->
      <div id="section-message" class="section-content bg-white dark:bg-slate-800 rounded-2xl shadow-xl border border-slate-200 dark:border-slate-700 overflow-hidden mb-8">
        <div class="p-6 lg:p-8 border-b border-slate-200 dark:border-slate-700">
          <div class="flex items-center gap-3 mb-3">
            <div class="w-10 h-10 bg-accent-100 dark:bg-accent-900/30 rounded-xl flex items-center justify-center flex-shrink-0">
              <svg class="w-5 h-5 text-accent-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
              </svg>
            </div>
            <h2 class="text-2xl font-bold text-slate-900 dark:text-white">
              Send Us a Message
            </h2>
          </div>
          <p class="text-slate-600 dark:text-slate-400 text-sm">
            Prefer email? Fill out the form below and we'll get back to you within 24 hours, usually much faster.
          </p>
        </div>
        <!-- Custom Form -->
        <div class="p-6 lg:p-8">
          <form id="contact-form" class="space-y-5">
            <div class="flex items-center justify-between rounded-lg bg-slate-100 dark:bg-slate-800 px-4 py-2">
              <p class="text-sm font-medium text-slate-700 dark:text-slate-300">Quick form (2 steps)</p>
              <p id="form-step-label" aria-live="polite" class="text-sm text-primary-700 dark:text-primary-300">Step 1 of 2</p>
            </div>

            <div id="form-step-1" class="space-y-5">
              <div class="grid sm:grid-cols-2 gap-5">
                <div>
                  <label for="firstname" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5">
                    First Name <span class="text-red-500">*</span>
                  </label>
                  <input
                    type="text"
                    id="firstname"
                    name="firstname"
                    required
                    autocomplete="given-name"
                    class="w-full px-4 py-3 rounded-xl border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-900 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200"
                    placeholder="John"
                  />
                  <p class="hidden mt-1 text-xs text-red-600 dark:text-red-400" data-error-for="firstname">Please enter your first name.</p>
                </div>
                <div>
                  <label for="lastname" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5">
                    Last Name <span class="text-red-500">*</span>
                  </label>
                  <input
                    type="text"
                    id="lastname"
                    name="lastname"
                    required
                    autocomplete="family-name"
                    class="w-full px-4 py-3 rounded-xl border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-900 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200"
                    placeholder="Smith"
                  />
                  <p class="hidden mt-1 text-xs text-red-600 dark:text-red-400" data-error-for="lastname">Please enter your last name.</p>
                </div>
              </div>

              <div>
                <label for="email" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5">
                  Email <span class="text-red-500">*</span>
                </label>
                <input
                  type="email"
                  id="email"
                  name="email"
                  required
                  autocomplete="email"
                  class="w-full px-4 py-3 rounded-xl border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-900 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200"
                  placeholder="john@company.com"
                />
                <p class="hidden mt-1 text-xs text-red-600 dark:text-red-400" data-error-for="email">Please enter a valid email address.</p>
              </div>

              <button
                type="button"
                id="next-step-btn"
                data-analytics="contact_form_step_1_continue_click"
                class="w-full py-3 px-4 rounded-xl bg-primary-600 hover:bg-primary-700 text-white font-semibold transition-colors"
              >
                Continue
              </button>
            </div>

            <div id="form-step-2" class="space-y-5 hidden">
              <div>
                <label for="phone" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5">
                  Phone
                </label>
                <input
                  type="tel"
                  id="phone"
                  name="phone"
                  autocomplete="tel"
                  class="w-full px-4 py-3 rounded-xl border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-900 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200"
                  placeholder="(416) 555-0123"
                />
              </div>

              <div>
                <label for="company" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5">
                  Company / Business Name
                </label>
                <input
                  type="text"
                  id="company"
                  name="company"
                  autocomplete="organization"
                  class="w-full px-4 py-3 rounded-xl border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-900 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200"
                  placeholder="Your Company Inc."
                />
              </div>

              <div>
                <label for="interested_in" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5">
                  What are you interested in? <span class="text-red-500">*</span>
                </label>
                <select
                  id="interested_in"
                  name="interested_in"
                  required
                  class="w-full px-4 py-3 rounded-xl border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-900 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200"
                >
                  <option value="" disabled selected>Select a service...</option>
                  <option value="New Website">New Website</option>
                  <option value="Website Redesign">Website Redesign</option>
                  <option value="Lead generation">Lead Generation</option>
                  <option value="Marketing Automation">Marketing Automation</option>
                  <option value="Other / Not Sure">Other / Not Sure</option>
                </select>
                <p class="hidden mt-1 text-xs text-red-600 dark:text-red-400" data-error-for="interested_in">Please select a service.</p>
              </div>

              <div>
                <label for="message" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5">
                  Message <span class="text-red-500">*</span>
                </label>
                <textarea
                  id="message"
                  name="message"
                  rows="4"
                  required
                  class="w-full px-4 py-3 rounded-xl border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-900 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200 resize-none"
                  placeholder="Tell us about your project or ask us anything..."
                ></textarea>
                <p class="hidden mt-1 text-xs text-red-600 dark:text-red-400" data-error-for="message">Please add a short message about your project.</p>
              </div>
            </div>

            <!-- Status messages -->
            <div id="form-success" aria-live="polite" class="hidden p-4 bg-accent-50 dark:bg-accent-900/20 border border-accent-200 dark:border-accent-800 rounded-xl">
              <div class="flex items-center gap-3">
                <svg class="w-5 h-5 text-accent-600 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                </svg>
                <p class="text-sm font-medium text-accent-700 dark:text-accent-300">Message sent! We'll get back to you within 24 hours.</p>
              </div>
            </div>
            <div id="form-error" role="alert" aria-live="assertive" class="hidden p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl">
              <div class="flex items-center gap-3">
                <svg class="w-5 h-5 text-red-600 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" />
                </svg>
                <p class="text-sm font-medium text-red-700 dark:text-red-300">Something went wrong. Please try again or email us directly.</p>
              </div>
            </div>

            <div id="form-actions" class="hidden flex-col sm:flex-row gap-3">
              <button type="button" id="prev-step-btn" class="flex-1 py-3 px-4 rounded-xl border border-slate-300 dark:border-slate-600 font-semibold text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
                Back
              </button>
              <button
                type="submit"
                id="submit-btn"
                data-analytics="contact_form_submit_click"
                class="flex-1 py-3 px-4 bg-accent-500 hover:bg-accent-600 text-white font-bold rounded-xl transition-all duration-200 hover:shadow-lg hover:shadow-accent-500/25 btn-pulse disabled:opacity-50 disabled:cursor-not-allowed"
              >
                Send Message
              </button>
            </div>

            <p class="text-xs text-slate-500 dark:text-slate-400 text-center">
              By submitting this form, you agree to our <a href="/privacy" class="underline hover:text-primary-600">Privacy Policy</a>.
            </p>
            <p class="text-xs text-slate-500 dark:text-slate-400 text-center">No spam. Your details are used only to respond to your inquiry.</p>
          </form>
        </div>
      </div>

      <!-- Book a Call Section -->
      <div id="section-call" class="section-content hidden bg-white dark:bg-slate-800 rounded-2xl shadow-xl border border-slate-200 dark:border-slate-700 overflow-hidden mb-8">
        <div class="p-6 lg:p-8 border-b border-slate-200 dark:border-slate-700">
          <div class="flex items-center gap-3 mb-3">
            <div class="w-10 h-10 bg-primary-100 dark:bg-primary-900/30 rounded-xl flex items-center justify-center flex-shrink-0">
              <svg class="w-5 h-5 text-primary-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
              </svg>
            </div>
            <h2 class="text-2xl font-bold text-slate-900 dark:text-white">
              Book a Free Call
            </h2>
          </div>
          <p class="text-slate-600 dark:text-slate-400 text-sm">
            Pick a time that works for you. We'll review your online presence, discuss your goals, and give you honest advice, whether you hire us or not.
          </p>
        </div>
        <div class="p-4 lg:p-6">
          <div id="meeting-embed-placeholder" class="mb-4 rounded-xl border border-dashed border-slate-300 dark:border-slate-600 bg-slate-50 dark:bg-slate-900/40 p-4 text-sm text-slate-600 dark:text-slate-300">
            Loading scheduler when you interact with the page. If it does not load, <a class="underline text-primary-600 dark:text-primary-400" href={bookingUrl} target="_blank" rel="noopener">open booking in a new tab</a>.
          </div>
          <iframe
            id="meeting-embed"
            src="about:blank"
            data-src={meetingEmbedUrl}
            title="Book a meeting with Lead Flow North"
            class="w-full min-h-[700px] rounded-xl border border-slate-200 dark:border-slate-700"
            loading="lazy"
            referrerpolicy="strict-origin-when-cross-origin"
          ></iframe>
          <noscript>
            <p class="mt-3 text-sm text-slate-600 dark:text-slate-300">JavaScript is required for the embedded scheduler. <a class="underline text-primary-600 dark:text-primary-400" href={bookingUrl} target="_blank" rel="noopener">Open booking page</a>.</p>
          </noscript>
        </div>
      </div>
    </div>
  </section>

  <!-- Contact Info Bar -->
  <section class="py-12 lg:py-16 bg-white dark:bg-slate-900">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-6">
        <div class="flex items-start gap-4">
          <div class="w-12 h-12 bg-primary-100 dark:bg-primary-900/30 rounded-xl flex items-center justify-center flex-shrink-0">
            <svg class="w-6 h-6 text-primary-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
            </svg>
          </div>
          <div>
            <p class="font-semibold text-slate-900 dark:text-white">Phone</p>
            <a href="tel:+19057835996" class="text-primary-600 dark:text-primary-400 hover:underline">(905) 783-5996</a>
          </div>
        </div>
        <div class="flex items-start gap-4">
          <div class="w-12 h-12 bg-primary-100 dark:bg-primary-900/30 rounded-xl flex items-center justify-center flex-shrink-0">
            <svg class="w-6 h-6 text-primary-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
            </svg>
          </div>
          <div>
            <p class="font-semibold text-slate-900 dark:text-white">Email</p>
            <a href="mailto:hello@leadflownorth.com" class="text-primary-600 dark:text-primary-400 hover:underline">hello@leadflownorth.com</a>
          </div>
        </div>
        <div class="flex items-start gap-4">
          <div class="w-12 h-12 bg-primary-100 dark:bg-primary-900/30 rounded-xl flex items-center justify-center flex-shrink-0">
            <svg class="w-6 h-6 text-primary-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
          </div>
          <div>
            <p class="font-semibold text-slate-900 dark:text-white">Offices</p>
            <p class="text-slate-600 dark:text-slate-400">Toronto, ON · Edmonton, AB</p>
          </div>
        </div>
        <div class="flex items-start gap-4">
          <div class="w-12 h-12 bg-primary-100 dark:bg-primary-900/30 rounded-xl flex items-center justify-center flex-shrink-0">
            <svg class="w-6 h-6 text-primary-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
          </div>
          <div>
            <p class="font-semibold text-slate-900 dark:text-white">Business Hours</p>
            <p class="text-slate-600 dark:text-slate-400">Mon – Fri, 9 AM – 5 PM EST</p>
          </div>
        </div>
      </div>
      <div class="mt-8 flex justify-center">
        <div class="inline-flex items-center gap-2 px-4 py-2 bg-accent-50 dark:bg-accent-900/20 rounded-full">
          <svg class="w-5 h-5 text-accent-600" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
          </svg>
          <span class="text-sm font-medium text-accent-700 dark:text-accent-400">We typically respond within 24 hours</span>
        </div>
      </div>
    </div>
  </section>

  <!-- FAQ -->
  <section class="py-16 lg:py-24 bg-slate-50 dark:bg-slate-800/50">
    <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="text-3xl font-bold text-slate-900 dark:text-white mb-8 text-center">
        Quick Answers
      </h2>
      <div class="space-y-4">
        {[
          { q: "How quickly do you respond?", a: "We typically respond to all inquiries within 24 hours on business days. Most messages get a reply within a few hours." },
          { q: "Do you offer free consultations?", a: "Yes! Our 15-minute discovery call is completely free with no obligation. We'll give you honest advice whether you hire us or not." },
          { q: "What's the best way to reach you?", a: "For quick questions, the message form is best. For project discussions, we recommend booking a call so we can give you our full attention." },
          { q: "What happens after I book a call?", a: "You'll receive a calendar invite with a video meeting link. On the call, we'll review your online presence, discuss your goals, and outline potential next steps." }
        ].map((faq) => (
          <details class="bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-700">
            <summary class="flex items-center justify-between p-6 cursor-pointer list-none">
              <span class="font-semibold text-slate-900 dark:text-white">{faq.q}</span>
              <svg class="w-5 h-5 text-slate-500 flex-shrink-0 ml-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
              </svg>
            </summary>
            <div class="px-6 pb-6">
              <p class="text-slate-600 dark:text-slate-300">{faq.a}</p>
            </div>
          </details>
        ))}
      </div>
    </div>
  </section>

  <!-- Bottom CTA -->
  <section class="py-16 lg:py-24 bg-gradient-to-br from-primary-600 to-primary-800 dark:from-primary-800 dark:to-primary-950">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <h2 class="text-3xl sm:text-4xl lg:text-5xl font-bold text-white mb-6">
        Still Have Questions?
      </h2>
      <p class="text-lg sm:text-xl text-primary-100 mb-8 max-w-2xl mx-auto">
        We're here to help. Reach out directly and we'll get back to you within 24 hours, usually much faster.
      </p>
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <a href="tel:+19057835996" class="inline-flex items-center justify-center px-8 py-4 bg-white text-primary-700 font-bold text-lg rounded-xl hover:bg-primary-50 transition-colors duration-200 shadow-xl">
          <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
          </svg>
          Call (905) 783-5996
        </a>
        <a href="mailto:hello@leadflownorth.com" class="inline-flex items-center justify-center px-8 py-4 bg-transparent text-white font-semibold text-lg rounded-xl border-2 border-white/50 hover:bg-white/10 hover:border-white transition-colors duration-200">
          <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
          </svg>
          hello@leadflownorth.com
        </a>
      </div>
      <p class="mt-6 text-sm text-primary-200">Monday – Friday, 9 AM – 5 PM EST · We typically respond within 24 hours.</p>
    </div>
  </section>

  <style>
    .option-card {
      cursor: pointer;
    }
    .option-card .check-icon {
      opacity: 0;
      transform: scale(0.8);
      transition: all 0.3s ease;
    }
    .option-card.active {
      border-color: rgb(249 115 22);
    }
    .dark .option-card.active {
      border-color: rgb(251 146 60);
    }
    .option-card:not(.active) {
      border-color: rgb(226 232 240);
    }
    .dark .option-card:not(.active) {
      border-color: rgb(51 65 85);
    }
    .section-content {
      animation: fadeIn 0.4s ease-out;
    }
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  </style>

  <!-- Option Toggle Script -->
  <script is:inline>
    (function() {
      var callBtn = document.getElementById('option-call');
      var messageBtn = document.getElementById('option-message');
      var callSection = document.getElementById('section-call');
      var messageSection = document.getElementById('section-message');
      var meetingEmbed = document.getElementById('meeting-embed');
      var meetingEmbedPlaceholder = document.getElementById('meeting-embed-placeholder');
      var meetingLoaded = false;

      function loadMeetingEmbed() {
        if (meetingLoaded || !meetingEmbed) return;
        var embedSrc = meetingEmbed.getAttribute('data-src');
        if (!embedSrc) return;
        meetingLoaded = true;
        meetingEmbed.setAttribute('src', embedSrc);
        meetingEmbed.removeAttribute('data-src');
        if (meetingEmbedPlaceholder) meetingEmbedPlaceholder.classList.add('hidden');
      }

      var interactionEvents = ['click', 'keydown', 'touchstart'];
      function bindInteractionLoad() {
        interactionEvents.forEach(function(evt) {
          window.addEventListener(evt, loadMeetingEmbed, { once: true, passive: true, capture: true });
        });
      }
      bindInteractionLoad();

      function showCall() {
        callBtn.classList.add('active');
        messageBtn.classList.remove('active');
        callBtn.setAttribute('aria-expanded', 'true');
        messageBtn.setAttribute('aria-expanded', 'false');
        callSection.classList.remove('hidden');
        messageSection.classList.add('hidden');
        loadMeetingEmbed();
      }

      function showMessage() {
        messageBtn.classList.add('active');
        callBtn.classList.remove('active');
        messageBtn.setAttribute('aria-expanded', 'true');
        callBtn.setAttribute('aria-expanded', 'false');
        messageSection.classList.remove('hidden');
        callSection.classList.add('hidden');
      }

      callBtn.addEventListener('click', showCall);
      messageBtn.addEventListener('click', showMessage);
    })();
  </script>

  <!-- Contact Form → HubSpot Forms API -->
  <script is:inline define:vars={{ hubspotContactFormEndpoint }}>
    (function() {
      var form = document.getElementById('contact-form');
      var submitBtn = document.getElementById('submit-btn');
      var nextStepBtn = document.getElementById('next-step-btn');
      var prevStepBtn = document.getElementById('prev-step-btn');
      var formStepLabel = document.getElementById('form-step-label');
      var formStep1 = document.getElementById('form-step-1');
      var formStep2 = document.getElementById('form-step-2');
      var formActions = document.getElementById('form-actions');
      var successMsg = document.getElementById('form-success');
      var errorMsg = document.getElementById('form-error');
      var track = window.trackLeadFlowEvent || function() {};

      if (!form) return;

      var stepOneInputs = ['firstname', 'lastname', 'email'].map(function(id) {
        return document.getElementById(id);
      }).filter(Boolean);

      function validateField(input) {
        if (!input) return true;
        var value = (input.value || '').trim();
        var valid = true;
        if (input.id === 'email') {
          valid = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(value);
        } else if (input.hasAttribute('required')) {
          valid = value.length > 0;
        }
        var errorEl = form.querySelector('[data-error-for="' + input.id + '"]');
        if (valid) {
          input.classList.remove('border-red-500');
          if (errorEl) errorEl.classList.add('hidden');
        } else {
          input.classList.add('border-red-500');
          if (errorEl) errorEl.classList.remove('hidden');
        }
        return valid;
      }

      function showStep(step) {
        var onStepTwo = step === 2;
        if (formStep1) formStep1.classList.toggle('hidden', onStepTwo);
        if (formStep2) formStep2.classList.toggle('hidden', !onStepTwo);
        if (formActions) formActions.classList.toggle('hidden', !onStepTwo);
        if (formStepLabel) formStepLabel.textContent = onStepTwo ? 'Step 2 of 2' : 'Step 1 of 2';
      }

      if (nextStepBtn) {
        nextStepBtn.addEventListener('click', function() {
          var valid = stepOneInputs.every(validateField);
          if (!valid) return;
          showStep(2);
          track('contact_form_step_1_complete', { page_path: window.location.pathname });
        });
      }

      if (prevStepBtn) {
        prevStepBtn.addEventListener('click', function() {
          showStep(1);
        });
      }

      stepOneInputs.forEach(function(input) {
        input.addEventListener('blur', function() {
          validateField(input);
        });
      });

      // Helper to read HubSpot tracking cookie
      function getHubspotCookie() {
        var match = document.cookie.match(/(?:^|;\s*)hubspotutk=([^;]*)/);
        return match ? decodeURIComponent(match[1]) : null;
      }

      form.addEventListener('submit', function(e) {
        e.preventDefault();

        // Hide previous messages
        successMsg.classList.add('hidden');
        errorMsg.classList.add('hidden');

        if (formStep2 && formStep2.classList.contains('hidden')) {
          var stepOneValid = stepOneInputs.every(validateField);
          if (stepOneValid) showStep(2);
          return;
        }

        var requiredFields = ['interested_in', 'message'].map(function(id) { return document.getElementById(id); }).filter(Boolean);
        var requiredValid = requiredFields.every(validateField);
        if (!requiredValid) return;

        track('contact_form_submit_attempt', { page_path: window.location.pathname });

        // Disable button
        submitBtn.disabled = true;
        submitBtn.textContent = 'Sending...';

        // Collect form data
        var fields = [
          { name: 'firstname', value: document.getElementById('firstname').value.trim() },
          { name: 'lastname', value: document.getElementById('lastname').value.trim() },
          { name: 'email', value: document.getElementById('email').value.trim() }
        ];

        var phone = document.getElementById('phone').value.trim();
        if (phone) fields.push({ name: 'phone', value: phone });

        var company = document.getElementById('company').value.trim();
        if (company) fields.push({ name: 'company', value: company });

        var interested = document.getElementById('interested_in').value;
        if (interested) fields.push({ name: 'what_are_you_interested_in_', value: interested });

        var message = document.getElementById('message').value.trim();
        if (message) fields.push({ name: 'message', value: message });

        // Build context with optional HubSpot tracking cookie
        var context = {
          pageUri: window.location.href,
          pageName: 'Contact Us'
        };
        var hutk = getHubspotCookie();
        if (hutk) context.hutk = hutk;

        var params = new URLSearchParams(window.location.search);
        var hasUtm = ['utm_source', 'utm_medium', 'utm_campaign', 'utm_term', 'utm_content'].some(function(key) {
          return !!params.get(key);
        });
        var hasClickIds = !!params.get('gclid') || !!params.get('fbclid');
        var attribution = hasUtm || hasClickIds ? {
          utm_source: params.get('utm_source') || '',
          utm_medium: params.get('utm_medium') || '',
          utm_campaign: params.get('utm_campaign') || '',
          utm_term: params.get('utm_term') || '',
          utm_content: params.get('utm_content') || '',
          gclid: params.get('gclid') || '',
          fbclid: params.get('fbclid') || ''
        } : null;

        if (attribution) {
          var trackingDetails = [
            attribution.utm_source ? ('utm_source=' + attribution.utm_source) : '',
            attribution.utm_medium ? ('utm_medium=' + attribution.utm_medium) : '',
            attribution.utm_campaign ? ('utm_campaign=' + attribution.utm_campaign) : '',
            attribution.utm_term ? ('utm_term=' + attribution.utm_term) : '',
            attribution.utm_content ? ('utm_content=' + attribution.utm_content) : '',
            attribution.gclid ? ('gclid=' + attribution.gclid) : '',
            attribution.fbclid ? ('fbclid=' + attribution.fbclid) : ''
          ].filter(Boolean).join(' | ');
          if (trackingDetails) {
            fields.push({ name: 'hs_analytics_source_data_1', value: trackingDetails });
          }
        }

        // Build payload
        var payload = {
          fields: fields,
          context: context
        };

        // Submit to HubSpot Forms API
        fetch(hubspotContactFormEndpoint, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        })
        .then(function(response) {
          if (response.ok) {
            successMsg.classList.remove('hidden');
            form.reset();
            showStep(1);
            track('contact_form_submit_success', { page_path: window.location.pathname });
            return;
          }
          return response.json().then(function(data) {
            console.error('HubSpot form error:', response.status, data);
            errorMsg.classList.remove('hidden');
            track('contact_form_submit_error', {
              page_path: window.location.pathname,
              status_code: String(response.status || 'unknown')
            });
          });
        })
        .catch(function(err) {
          console.error('HubSpot form network error:', err);
          errorMsg.classList.remove('hidden');
          track('contact_form_submit_error', {
            page_path: window.location.pathname,
            status_code: 'network_error'
          });
        })
        .finally(function() {
          submitBtn.disabled = false;
          submitBtn.textContent = 'Send Message';
        });
      });
    })();
  </script>
</Layout>
