---
import Layout from '../layouts/Layout.astro';

// Job openings data
const jobs = [
  {
    id: "account-manager",
    title: "Account Manager",
    type: "Part-Time / Contract",
    location: "Remote (Canada)",
    compensation: "$25/hour",
    description: "We're looking for a client-focused Account Manager to be the primary point of contact for our growing roster of small business clients. You'll ensure projects stay on track, clients stay happy, and nothing falls through the cracks.",
    responsibilities: [
      "Serve as the main point of contact for 10-15 active client accounts",
      "Coordinate project timelines, deliverables, and client communications",
      "Conduct weekly check-ins with clients and relay feedback to the team",
      "Identify upsell opportunities and help clients get more value from our services",
      "Maintain CRM records and ensure all client data is accurate and up-to-date",
      "Handle client onboarding for new projects and ensure smooth handoffs"
    ],
    requirements: [
      "2+ years of account management, client success, or project coordination experience",
      "Excellent written and verbal communication skills",
      "Experience with CRM tools (HubSpot, Salesforce, or similar)",
      "Highly organized with strong attention to detail",
      "Comfortable working independently in a remote environment",
      "Based in Canada (EST or MST timezone preferred)"
    ],
    niceToHave: [
      "Experience in digital marketing or web development agencies",
      "Familiarity with project management tools (Notion, Asana, Monday)",
      "Background in small business or startup environments"
    ]
  },
  {
    id: "web-associate-intern",
    title: "Web Associate Intern",
    type: "Internship (Unpaid)",
    location: "Remote (Canada)",
    compensation: "Unpaid â€“ Academic Credit Available",
    description: "Kickstart your career in web development! Join our team as a Web Associate Intern and get hands-on experience building real websites for real clients. Perfect for students or recent grads looking to build their portfolio.",
    responsibilities: [
      "Assist with building and updating client websites using modern frameworks",
      "Help implement responsive designs from Figma mockups",
      "Perform quality assurance testing across browsers and devices",
      "Write and format content for client websites and blog posts",
      "Learn our development workflow and best practices",
      "Participate in weekly team meetings and client presentations"
    ],
    requirements: [
      "Currently enrolled in or recently graduated from a web development, computer science, or related program",
      "Basic understanding of HTML, CSS, and JavaScript",
      "Eagerness to learn and take on new challenges",
      "Strong attention to detail and ability to follow instructions",
      "Reliable internet connection and ability to work 15-20 hours/week",
      "Based in Canada"
    ],
    niceToHave: [
      "Familiarity with React, Astro, or other modern frameworks",
      "Basic understanding of Git and version control",
      "Interest in SEO and digital marketing",
      "Design skills or experience with Figma/Canva"
    ],
    duration: "3-6 months with potential for paid position"
  }
];

// Structured data for job postings
const jobPostingSchema = jobs.map(job => ({
  "@context": "https://schema.org",
  "@type": "JobPosting",
  "title": job.title,
  "description": job.description,
  "datePosted": "2026-02-01",
  "validThrough": "2026-04-30",
  "employmentType": job.type.includes("Internship") ? "INTERN" : "PART_TIME",
  "hiringOrganization": {
    "@type": "Organization",
    "name": "Lead Flow North",
    "sameAs": "https://leadflownorth.com",
    "logo": "https://leadflownorth.com/logo.svg"
  },
  "jobLocation": {
    "@type": "Place",
    "address": {
      "@type": "PostalAddress",
      "addressCountry": "CA"
    }
  },
  "jobLocationType": "TELECOMMUTE",
  "applicantLocationRequirements": {
    "@type": "Country",
    "name": "Canada"
  },
  ...(job.compensation.includes("$") && {
    "baseSalary": {
      "@type": "MonetaryAmount",
      "currency": "CAD",
      "value": {
        "@type": "QuantitativeValue",
        "value": 25,
        "unitText": "HOUR"
      }
    }
  })
}));
---

<Layout 
  title="Careers"
  description="Join the Lead Flow North team! We're hiring an Account Manager and Web Associate Intern. Remote positions available for Canadian residents."
  structuredData={jobPostingSchema[0]}
>
  <!-- Hero Section -->
  <section class="pt-24 pb-16 lg:pt-32 lg:pb-24 bg-gradient-to-br from-primary-50 via-white to-accent-50 dark:from-slate-900 dark:via-slate-900 dark:to-slate-800">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <div class="reveal">
        <span class="inline-flex items-center gap-2 px-4 py-2 bg-accent-100 dark:bg-accent-900/30 rounded-full mb-6">
          <span class="relative flex h-2 w-2">
            <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-accent-400 opacity-75"></span>
            <span class="relative inline-flex rounded-full h-2 w-2 bg-accent-500"></span>
          </span>
          <span class="text-sm font-semibold text-accent-700 dark:text-accent-300">We're Hiring!</span>
        </span>
        <h1 class="text-4xl sm:text-5xl lg:text-6xl font-extrabold text-slate-900 dark:text-white mb-6">
          Build Something <span class="text-primary-600">Meaningful</span>
        </h1>
        <p class="text-xl text-slate-600 dark:text-slate-300 max-w-2xl mx-auto">
          Join a small team making a big impact. We help Canadian small businesses growâ€”and we're looking for people who care about doing great work.
        </p>
      </div>
    </div>
  </section>

  <!-- Why Work With Us -->
  <section class="py-16 lg:py-24 bg-white dark:bg-slate-900">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-12 reveal">
        <h2 class="text-3xl font-bold text-slate-900 dark:text-white mb-4">Why Lead Flow North?</h2>
        <p class="text-lg text-slate-600 dark:text-slate-400 max-w-2xl mx-auto">
          We're not a big agency with layers of bureaucracy. We're a tight-knit team that values results over process.
        </p>
      </div>
      
      <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
        {[
          { icon: "ðŸ ", title: "100% Remote", desc: "Work from anywhere in Canada. We trust you to get things done." },
          { icon: "ðŸ“ˆ", title: "Real Impact", desc: "Your work directly helps small businesses succeed and grow." },
          { icon: "ðŸŽ“", title: "Learn & Grow", desc: "We invest in your development with mentorship and new challenges." },
          { icon: "ðŸ¤", title: "Small Team", desc: "Your voice matters. No corporate politics, just collaboration." }
        ].map((item) => (
          <div class="reveal bg-slate-50 dark:bg-slate-800 rounded-xl p-6 text-center">
            <div class="text-4xl mb-4">{item.icon}</div>
            <h3 class="font-bold text-slate-900 dark:text-white mb-2">{item.title}</h3>
            <p class="text-sm text-slate-600 dark:text-slate-400">{item.desc}</p>
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- Open Positions -->
  <section class="py-16 lg:py-24 bg-slate-50 dark:bg-slate-800/50">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-12 reveal">
        <h2 class="text-3xl font-bold text-slate-900 dark:text-white mb-4">Open Positions</h2>
        <p class="text-lg text-slate-600 dark:text-slate-400">
          {jobs.length} {jobs.length === 1 ? 'position' : 'positions'} available
        </p>
      </div>

      <div class="space-y-6">
        {jobs.map((job, index) => (
          <div class="reveal bg-white dark:bg-slate-900 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden" style={`animation-delay: ${index * 100}ms`}>
            <!-- Job Header -->
            <div class="p-6 lg:p-8">
              <!-- Title and Apply Button Row -->
              <div class="flex items-start justify-between gap-4 mb-4">
                <h3 class="text-2xl font-bold text-slate-900 dark:text-white">{job.title}</h3>
                <button 
                  class="apply-btn flex-shrink-0 px-6 py-2.5 bg-primary-600 hover:bg-primary-700 text-white font-semibold rounded-lg transition-all duration-200 hover:shadow-lg"
                  data-job={job.id}
                  data-title={job.title}
                >
                  Apply Now
                </button>
              </div>
              
              <!-- Tags Row -->
              <div class="flex flex-wrap gap-2 mb-5">
                <span class="inline-flex items-center gap-1.5 px-3 py-1.5 bg-primary-50 dark:bg-primary-900/20 text-primary-700 dark:text-primary-300 rounded-lg text-sm font-medium border border-primary-200 dark:border-primary-800">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg>
                  {job.type}
                </span>
                <span class="inline-flex items-center gap-1.5 px-3 py-1.5 bg-slate-50 dark:bg-slate-800 text-slate-700 dark:text-slate-300 rounded-lg text-sm font-medium border border-slate-200 dark:border-slate-700">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                  {job.location}
                </span>
                <span class="inline-flex items-center gap-1.5 px-3 py-1.5 bg-accent-50 dark:bg-accent-900/20 text-accent-700 dark:text-accent-300 rounded-lg text-sm font-medium border border-accent-200 dark:border-accent-800">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                  {job.compensation}
                </span>
              </div>
              
              <!-- Description -->
              <p class="text-slate-600 dark:text-slate-400 mb-5 leading-relaxed">{job.description}</p>
              
              {job.duration && (
                <div class="inline-flex items-center gap-2 px-3 py-2 bg-amber-50 dark:bg-amber-900/20 text-amber-700 dark:text-amber-300 rounded-lg text-sm font-medium mb-5 border border-amber-200 dark:border-amber-800">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                  {job.duration}
                </div>
              )}

              <!-- Expandable Details -->
              <details class="group">
                <summary class="cursor-pointer text-primary-600 dark:text-primary-400 font-medium hover:text-primary-700 dark:hover:text-primary-300 inline-flex items-center gap-2">
                  <span>View Full Job Description</span>
                  <svg class="w-5 h-5 transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </summary>
                
                <div class="mt-6 space-y-6 pt-6 border-t border-slate-200 dark:border-slate-700">
                  <!-- Responsibilities -->
                  <div>
                    <h4 class="font-semibold text-slate-900 dark:text-white mb-3">What You'll Do</h4>
                    <ul class="space-y-2">
                      {job.responsibilities.map((item) => (
                        <li class="flex items-start gap-2 text-slate-600 dark:text-slate-400">
                          <svg class="w-5 h-5 text-accent-500 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                          <span>{item}</span>
                        </li>
                      ))}
                    </ul>
                  </div>
                  
                  <!-- Requirements -->
                  <div>
                    <h4 class="font-semibold text-slate-900 dark:text-white mb-3">What We're Looking For</h4>
                    <ul class="space-y-2">
                      {job.requirements.map((item) => (
                        <li class="flex items-start gap-2 text-slate-600 dark:text-slate-400">
                          <svg class="w-5 h-5 text-primary-500 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                          <span>{item}</span>
                        </li>
                      ))}
                    </ul>
                  </div>
                  
                  <!-- Nice to Have -->
                  <div>
                    <h4 class="font-semibold text-slate-900 dark:text-white mb-3">Nice to Have</h4>
                    <ul class="space-y-2">
                      {job.niceToHave.map((item) => (
                        <li class="flex items-start gap-2 text-slate-600 dark:text-slate-400">
                          <svg class="w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path></svg>
                          <span>{item}</span>
                        </li>
                      ))}
                    </ul>
                  </div>
                </div>
              </details>
            </div>
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- Application Form Modal -->
  <div id="application-modal" class="fixed inset-0 z-50 hidden">
    <!-- Backdrop -->
    <div class="modal-backdrop fixed inset-0 bg-slate-900/60 backdrop-blur-sm"></div>
    
    <!-- Modal Content -->
    <div class="fixed inset-0 overflow-y-auto">
      <div class="flex min-h-full items-center justify-center p-4">
        <div class="modal-content relative w-full max-w-2xl bg-white dark:bg-slate-900 rounded-2xl shadow-2xl transform transition-all">
          <!-- Close Button -->
          <button id="close-modal" class="absolute top-4 right-4 p-2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 transition-colors">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
          </button>
          
          <!-- Form Container -->
          <div id="form-container" class="p-6 lg:p-8">
            <div class="mb-6">
              <h2 class="text-2xl font-bold text-slate-900 dark:text-white mb-2">Apply for <span id="job-title-display">this position</span></h2>
              <p class="text-slate-600 dark:text-slate-400">Fill out the form below and we'll be in touch soon.</p>
            </div>
            
            <!-- Application Form -->
            <form action="https://formspree.io/f/xdalnyza" method="POST" enctype="multipart/form-data" id="application-form" class="space-y-5">
              <input type="hidden" id="position" name="position" value="">
              
              <!-- Name -->
              <div>
                <label for="name" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Full Name <span class="text-red-500">*</span></label>
                <input 
                  type="text" 
                  id="name" 
                  name="name" 
                  required
                  class="w-full px-4 py-3 rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors"
                  placeholder="John Smith"
                >
              </div>
              
              <!-- Email -->
              <div>
                <label for="email" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Email Address <span class="text-red-500">*</span></label>
                <input 
                  type="email" 
                  id="email" 
                  name="email" 
                  required
                  class="w-full px-4 py-3 rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors"
                  placeholder="john@example.com"
                >
              </div>
              
              <!-- Phone -->
              <div>
                <label for="phone" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Phone Number <span class="text-red-500">*</span></label>
                <input 
                  type="tel" 
                  id="phone" 
                  name="phone" 
                  required
                  class="w-full px-4 py-3 rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors"
                  placeholder="(416) 555-0123"
                >
              </div>
              
              <!-- LinkedIn (Optional) -->
              <div>
                <label for="linkedin" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">LinkedIn Profile <span class="text-slate-400">(optional)</span></label>
                <input 
                  type="url" 
                  id="linkedin" 
                  name="linkedin"
                  class="w-full px-4 py-3 rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors"
                  placeholder="https://linkedin.com/in/yourprofile"
                >
              </div>
              
              <!-- Resume Upload -->
              <div>
                <label for="resume" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Resume <span class="text-red-500">*</span></label>
                <div class="relative">
                  <input 
                    type="file" 
                    id="resume" 
                    name="resume" 
                    required
                    accept=".pdf,.doc,.docx,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document"
                    class="hidden"
                  >
                  <label 
                    for="resume" 
                    id="resume-label"
                    class="flex items-center justify-center gap-3 w-full px-4 py-6 rounded-lg border-2 border-dashed border-slate-300 dark:border-slate-600 bg-slate-50 dark:bg-slate-800/50 cursor-pointer hover:border-primary-500 dark:hover:border-primary-500 transition-colors"
                  >
                    <svg class="w-8 h-8 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path></svg>
                    <div class="text-center">
                      <span id="resume-text" class="text-slate-600 dark:text-slate-400">Click to upload or drag and drop</span>
                      <p class="text-xs text-slate-400 mt-1">PDF or DOCX (max 5MB)</p>
                    </div>
                  </label>
                </div>
                <p id="file-error" class="hidden mt-2 text-sm text-red-500">Please upload a PDF or DOCX file only.</p>
              </div>
              
              <!-- Cover Letter -->
              <div>
                <label for="cover-letter" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Cover Letter <span class="text-red-500">*</span></label>
                <textarea 
                  id="cover-letter" 
                  name="cover-letter" 
                  rows="4"
                  required
                  class="w-full px-4 py-3 rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors resize-none"
                  placeholder="Tell us why you're interested in this role and what makes you a great fit..."
                ></textarea>
              </div>
              
              <!-- Submit Button -->
              <button 
                type="submit"
                class="w-full px-6 py-4 bg-accent-500 hover:bg-accent-600 text-white font-semibold rounded-lg transition-all duration-200 hover:shadow-lg hover:shadow-accent-500/25 flex items-center justify-center gap-2"
              >
                <span>Submit Application</span>
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path></svg>
              </button>
            </form>
          </div>
          
          <!-- Success State (Hidden by default) -->
          <div id="success-state" class="hidden p-8 text-center">
            <div class="w-20 h-20 bg-accent-100 dark:bg-accent-900/30 rounded-full flex items-center justify-center mx-auto mb-6">
              <svg class="w-10 h-10 text-accent-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
            </div>
            <h3 class="text-2xl font-bold text-slate-900 dark:text-white mb-2">Application Submitted!</h3>
            <p class="text-slate-600 dark:text-slate-400 mb-6">
              Thanks for your interest in joining Lead Flow North. We'll review your application and get back to you within 5 business days.
            </p>
            <button id="close-success" class="px-6 py-3 bg-primary-600 hover:bg-primary-700 text-white font-semibold rounded-lg transition-colors">
              Close
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Don't See a Fit? -->
  <section class="py-16 lg:py-24 bg-white dark:bg-slate-900">
    <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <div class="reveal">
        <h2 class="text-2xl font-bold text-slate-900 dark:text-white mb-4">Don't See a Perfect Fit?</h2>
        <p class="text-lg text-slate-600 dark:text-slate-400 mb-6">
          We're always interested in hearing from talented people. If you think you'd be a great addition to our team, send us your resume anyway.
        </p>
        <a 
          href="mailto:careers@leadflownorth.com?subject=General Application"
          class="inline-flex items-center gap-2 px-6 py-3 bg-slate-100 dark:bg-slate-800 hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-900 dark:text-white font-semibold rounded-lg transition-colors"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg>
          Email careers@leadflownorth.com
        </a>
      </div>
    </div>
  </section>
</Layout>

<style>
  /* Modal animations */
  #application-modal.show .modal-backdrop {
    animation: fadeIn 0.2s ease-out forwards;
  }
  
  #application-modal.show .modal-content {
    animation: slideUp 0.3s ease-out forwards;
  }
  
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }
  
  @keyframes slideUp {
    from { 
      opacity: 0;
      transform: translateY(20px) scale(0.95);
    }
    to { 
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }
  
  /* File upload drag state */
  #resume-label.drag-over {
    border-color: rgb(59 130 246);
    background-color: rgb(239 246 255);
  }
  
  :root.dark #resume-label.drag-over {
    background-color: rgb(30 58 138 / 0.3);
  }
</style>

<script>
  // Modal functionality
  const modal = document.getElementById('application-modal');
  const closeBtn = document.getElementById('close-modal');
  const closeSuccess = document.getElementById('close-success');
  const applyBtns = document.querySelectorAll('.apply-btn');
  const jobTitleDisplay = document.getElementById('job-title-display');
  const positionInput = document.getElementById('position') as HTMLInputElement;
  const form = document.getElementById('application-form') as HTMLFormElement;
  const formContainer = document.getElementById('form-container');
  const successState = document.getElementById('success-state');
  
  // File upload elements
  const resumeInput = document.getElementById('resume') as HTMLInputElement;
  const resumeLabel = document.getElementById('resume-label');
  const resumeText = document.getElementById('resume-text');
  const fileError = document.getElementById('file-error');
  
  // Open modal
  applyBtns.forEach(btn => {
    btn.addEventListener('click', () => {
      const jobId = btn.getAttribute('data-job');
      const jobTitle = btn.getAttribute('data-title');
      
      if (jobTitleDisplay) jobTitleDisplay.textContent = jobTitle || 'this position';
      if (positionInput) positionInput.value = jobId || '';
      
      modal?.classList.remove('hidden');
      modal?.classList.add('show');
      document.body.style.overflow = 'hidden';
      
      // Reset form state
      form?.reset();
      formContainer?.classList.remove('hidden');
      successState?.classList.add('hidden');
      if (resumeText) resumeText.textContent = 'Click to upload or drag and drop';
      resumeLabel?.classList.remove('border-accent-500', 'bg-accent-50', 'dark:bg-accent-900/20');
    });
  });
  
  // Close modal
  const closeModal = () => {
    modal?.classList.add('hidden');
    modal?.classList.remove('show');
    document.body.style.overflow = '';
  };
  
  closeBtn?.addEventListener('click', closeModal);
  closeSuccess?.addEventListener('click', closeModal);
  
  // Close on backdrop click
  modal?.addEventListener('click', (e) => {
    if ((e.target as Element).classList.contains('modal-backdrop')) {
      closeModal();
    }
  });
  
  // Close on Escape key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && !modal?.classList.contains('hidden')) {
      closeModal();
    }
  });
  
  // File upload handling
  const allowedTypes = [
    'application/pdf',
    'application/msword',
    'application/vnd.openxmlformats-officedocument.wordprocessingml.document'
  ];
  const allowedExtensions = ['.pdf', '.doc', '.docx'];
  
  const validateFile = (file: File): boolean => {
    const extension = '.' + file.name.split('.').pop()?.toLowerCase();
    const isValidType = allowedTypes.includes(file.type) || allowedExtensions.includes(extension);
    const isValidSize = file.size <= 5 * 1024 * 1024; // 5MB
    
    if (!isValidType) {
      fileError?.classList.remove('hidden');
      if (fileError) fileError.textContent = 'Please upload a PDF or DOCX file only.';
      return false;
    }
    
    if (!isValidSize) {
      fileError?.classList.remove('hidden');
      if (fileError) fileError.textContent = 'File size must be under 5MB.';
      return false;
    }
    
    fileError?.classList.add('hidden');
    return true;
  };
  
  resumeInput?.addEventListener('change', () => {
    const file = resumeInput.files?.[0];
    if (file && validateFile(file)) {
      if (resumeText) resumeText.textContent = file.name;
      resumeLabel?.classList.add('border-accent-500', 'bg-accent-50', 'dark:bg-accent-900/20');
    } else {
      resumeInput.value = '';
      if (resumeText) resumeText.textContent = 'Click to upload or drag and drop';
      resumeLabel?.classList.remove('border-accent-500', 'bg-accent-50', 'dark:bg-accent-900/20');
    }
  });
  
  // Drag and drop
  resumeLabel?.addEventListener('dragover', (e) => {
    e.preventDefault();
    resumeLabel.classList.add('drag-over');
  });
  
  resumeLabel?.addEventListener('dragleave', () => {
    resumeLabel.classList.remove('drag-over');
  });
  
  resumeLabel?.addEventListener('drop', (e) => {
    e.preventDefault();
    resumeLabel.classList.remove('drag-over');
    
    const file = (e as DragEvent).dataTransfer?.files[0];
    if (file && validateFile(file)) {
      // Create a new DataTransfer to set the files
      const dt = new DataTransfer();
      dt.items.add(file);
      resumeInput.files = dt.files;
      
      if (resumeText) resumeText.textContent = file.name;
      resumeLabel?.classList.add('border-accent-500', 'bg-accent-50', 'dark:bg-accent-900/20');
    }
  });
  
  // Form submission (mockup)
  form?.addEventListener('submit', (e) => {
    e.preventDefault();
    
    // Validate file is selected
    if (!resumeInput.files?.length) {
      fileError?.classList.remove('hidden');
      if (fileError) fileError.textContent = 'Please upload your resume.';
      return;
    }
    
    // Show success state (mockup - no actual submission)
    formContainer?.classList.add('hidden');
    successState?.classList.remove('hidden');
  });
</script>
